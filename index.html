<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cotizador - NEMOC Ingenier√≠a y Tecnolog√≠a</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #003366; }
    label { display: block; margin-top: 10px; }
    input { margin: 5px; padding: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f2f2f2; }
    button { margin-top: 15px; padding: 10px 20px; cursor: pointer; background: #003366; color: white; border: none; border-radius: 5px; }
    button:hover { background: #0055aa; }
  </style>
</head>
<body>
  <h2>Generador de Cotizaciones - NEMOC</h2>

  <label>Cliente: <input type="text" id="cliente"></label>
  <label>Correo: <input type="email" id="correo"></label>
  <label>Fecha: <input type="date" id="fecha"></label>

  <h3>Agregar √çtems</h3>
  <label>Descripci√≥n: <input type="text" id="descripcion"></label>
  <label>Cantidad: <input type="number" id="cantidad" value="1"></label>
  <label>Valor Unitario: <input type="number" id="valor" value="0"></label>
  <button onclick="agregarItem()">‚ûï Agregar √çtem</button>

  <table id="tablaItems">
    <thead>
      <tr>
        <th>Descripci√≥n</th>
        <th>Cantidad</th>
        <th>Valor Unitario</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Total General: $<span id="totalGeneral">0</span></h3>

  <button onclick="generarPDF()">üìÑ Generar PDF</button>

  <script>
    let items = [];

    function agregarItem() {
      let descripcion = document.getElementById("descripcion").value;
      let cantidad = parseInt(document.getElementById("cantidad").value);
      let valor = parseFloat(document.getElementById("valor").value);
      let total = cantidad * valor;

      if (descripcion && cantidad > 0 && valor >= 0) {
        items.push({ descripcion, cantidad, valor, total });
        actualizarTabla();
      }
    }

    function actualizarTabla() {
      let tbody = document.querySelector("#tablaItems tbody");
      tbody.innerHTML = "";
      let totalGeneral = 0;

      items.forEach((item, i) => {
        let row = `<tr>
          <td>${item.descripcion}</td>
          <td>${item.cantidad}</td>
          <td>$${item.valor.toLocaleString()}</td>
          <td>$${item.total.toLocaleString()}</td>
        </tr>`;
        tbody.innerHTML += row;
        totalGeneral += item.total;
      });

      document.getElementById("totalGeneral").innerText = totalGeneral.toLocaleString();
    }

    async function generarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      let cliente = document.getElementById("cliente").value;
      let correo = document.getElementById("correo").value;
      let fecha = document.getElementById("fecha").value;
      let totalGeneral = document.getElementById("totalGeneral").innerText;

      // Encabezado
      doc.setFontSize(18);
      doc.text("COTIZACI√ìN", 20, 20);
      doc.setFontSize(12);
      doc.text("NEMOC Ingenier√≠a y Tecnolog√≠a", 20, 30);
      doc.text(`Cliente: ${cliente}`, 20, 50);
      doc.text(`Correo: ${correo}`, 20, 60);
      doc.text(`Fecha: ${fecha}`, 20, 70);

      // Tabla de items
      let y = 90;
      doc.text("√çtems:", 20, y);
      y += 10;

      items.forEach(item => {
        doc.text(`${item.descripcion} - Cant: ${item.cantidad} - Vlr: $${item.valor} - Total: $${item.total}`, 20, y);
        y += 10;
      });

      // Total general
      y += 10;
      doc.setFontSize(14);
      doc.text(`TOTAL GENERAL: $${totalGeneral}`, 20, y);

      doc.save("cotizacion.pdf");
    }
  </script>
</body>
</html>
